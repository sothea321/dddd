<!DOCTYPE html>
<html lang="km">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VOD Premium - Compact Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kantumruy+Pro:wght@300;400;600;700&display=swap');
        
        body {
            font-family: 'Kantumruy Pro', sans-serif;
            background: #020617;
            color: #f8fafc;
            min-height: 100vh;
        }

        .glass {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            background: #000;
            border-radius: 20px;
        }

        .video-container iframe, .video-container video, .video-locked {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%; border: 0; z-index: 20;
        }

        .btn-primary { background: linear-gradient(135deg, #3b82f6, #8b5cf6); }
        .btn-admin { background: linear-gradient(135deg, #f59e0b, #d97706); }

        .user-card {
            background: #1e293b !important;
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 1.25rem;
            transition: all 0.2s ease;
        }
        .user-card:hover { 
            transform: scale(1.01);
            border-color: rgba(245, 158, 11, 0.4);
            background: #243147 !important;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 10px;
            z-index: 200;
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
        
        .stat-card {
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .playlist-lock-overlay {
            position: absolute;
            inset: 0;
            background: rgba(2, 6, 23, 0.8);
            backdrop-blur: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 50;
            text-align: center;
            padding: 20px;
        }
    </style>
</head>
<body class="p-3 lg:p-6">

    <div id="toast-container"></div>

    <div class="max-w-[1200px] mx-auto">
        <header class="flex justify-between items-center mb-6 bg-white/5 p-3 rounded-2xl border border-white/5">
            <div class="flex items-center gap-3 text-white">
                <div class="w-10 h-10 btn-primary rounded-xl flex items-center justify-center text-xl shadow-lg cursor-pointer hover:scale-105 transition-transform" onclick="handleAdminIconClick()">ğŸ›¡ï¸</div>
                <div>
                    <h1 class="text-xl font-black bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-400 uppercase tracking-tight">VOD Premium</h1>
                    <div id="user-status-display" class="text-[10px] text-slate-400 font-bold uppercase tracking-widest">áŸáŸ’áá¶á“á—á¶á–: Guest</div>
                </div>
            </div>
            <button id="auth-btn" onclick="toggleModal('user-login-modal')" class="glass px-6 py-2 rounded-xl text-xs font-black text-white hover:bg-white/10 transition-all border border-white/10">á…á¼á›á”áŸ’ášá¾á”áŸ’ášá¶áŸáŸ‹</button>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            <div class="lg:col-span-8 space-y-6">
                <div id="player-wrapper" class="video-container shadow-2xl overflow-hidden border border-white/5">
                    <div id="locked-ui" class="video-locked flex flex-col items-center justify-center text-center p-6 bg-slate-950/90 backdrop-blur-lg">
                        <div class="text-5xl mb-4">ğŸ”</div>
                        <h2 class="text-xl font-black mb-3 text-white uppercase">áŸá¼á˜á…á¼á›á”áŸ’ášá¾á”áŸ’ášá¶áŸáŸ‹á‚áá“á¸</h2>
                        <button onclick="toggleModal('user-login-modal')" class="btn-primary px-8 py-3 rounded-2xl font-black text-sm text-white shadow-xl hover:opacity-90 active:scale-95 transition-all">á…á¼á› Login á¥á¡á¼áœá“áŸáŸ‡</button>
                    </div>
                </div>
                <div class="glass p-6 rounded-[2rem]">
                    <h2 id="current-title" class="text-xl font-black text-white mb-1 tracking-tight">áŸá¼á˜á‡áŸ’ášá¾áŸášá¾áŸáœá¸áŠáŸá¢á¼</h2>
                    <p id="current-desc" class="text-slate-400 text-sm leading-relaxed">ášá¸á€ášá¶á™á‡á¶á˜á½á™á€á¶ášá‘áŸáŸ’áŸá“á¶áœá¸áŠáŸá¢á¼á€á˜áŸ’áŸá¶á“áŸ’áá€á˜áŸ’ášá·áá…áŸ’á”á¶áŸáŸ‹áŸ”</p>
                </div>
            </div>

            <div class="lg:col-span-4">
                <div class="glass rounded-[2rem] h-[500px] flex flex-col overflow-hidden shadow-2xl relative">
                    <div class="p-4 border-b border-white/5 text-slate-400 text-[10px] font-black uppercase tracking-widest flex justify-between">
                        <span>á”á‰áŸ’á‡á¸á—á¶á‚</span>
                        <span id="video-count-badge" class="text-blue-400">0 á—á¶á‚</span>
                    </div>
                    
                    <div id="playlist-lock" class="playlist-lock-overlay">
                        <div class="text-3xl mb-2">ğŸ”’</div>
                        <p class="text-[10px] font-black text-slate-400 uppercase tracking-widest">á”á‰áŸ’á‡á¸á—á¶á‚ááŸ’ášá¼áœá”á¶á“á›á¶á€áŸ‹</p>
                        <p class="text-[9px] text-slate-500 mt-1">áŸá¼á˜á…á¼á›á”áŸ’ášá¾á”áŸ’ášá¶áŸáŸ‹áŠá¾á˜áŸ’á”á¸á˜á¾á›á—á¶á‚á‘á¶áŸ†á„á¢áŸáŸ‹</p>
                    </div>

                    <div id="playlist" class="flex-1 overflow-y-auto p-3 space-y-2 custom-scrollbar"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- User Login Modal -->
    <div id="user-login-modal" class="fixed inset-0 bg-black/90 backdrop-blur-md z-[100] hidden items-center justify-center p-4">
        <div class="glass max-w-sm w-full p-8 rounded-[2rem] text-white">
            <h3 class="text-xl font-black text-center mb-6 uppercase">User Login</h3>
            <div class="space-y-4">
                <input type="text" id="login-user" placeholder="áˆáŸ’á˜áŸ„áŸ‡á¢áŸ’á“á€á”áŸ’ášá¾" class="w-full bg-white/5 border border-white/10 rounded-xl p-3 text-sm outline-none focus:border-blue-500 transition-all">
                <input type="password" id="login-pass" placeholder="á›áŸááŸá˜áŸ’á„á¶ááŸ‹" class="w-full bg-white/5 border border-white/10 rounded-xl p-3 text-sm outline-none focus:border-blue-500 transition-all">
                <button onclick="handleUserLogin()" class="w-full btn-primary py-3 rounded-xl text-sm font-black shadow-lg">á…á¼á›á‘áŸáŸ’áŸá“á¶</button>
                <button onclick="toggleModal('user-login-modal')" class="w-full text-slate-500 text-xs font-bold pt-2 hover:text-white">á”á·á‘</button>
            </div>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="admin-login-modal" class="fixed inset-0 bg-black/90 backdrop-blur-md z-[100] hidden items-center justify-center p-4">
        <div class="glass max-w-xs w-full p-8 rounded-[2rem] text-white text-center">
            <h3 class="text-lg font-black mb-6 text-amber-500 uppercase">Admin Access</h3>
            <p class="text-[10px] text-slate-500 mb-2 uppercase font-bold tracking-widest">á”á‰áŸ’á…á¼á›á›áŸáá€á¼áŠáŸá˜áŸ’á„á¶ááŸ‹á¢áŸ’á“á€á‚áŸ’ášá”áŸ‹á‚áŸ’ášá„</p>
            <input type="password" id="admin-pass-input" placeholder="â€¢â€¢â€¢â€¢" class="w-full bg-white/5 border border-white/10 rounded-xl p-3 text-center text-2xl font-black outline-none mb-6 focus:border-amber-500">
            <button onclick="handleAdminLogin()" class="w-full btn-admin py-3 rounded-xl text-sm font-black shadow-lg">á”á‰áŸ’á‡á¶á€áŸ‹</button>
            <button onclick="toggleModal('admin-login-modal')" class="w-full text-slate-500 text-xs font-bold pt-2 hover:text-white">á”áŸ„áŸ‡á”á„áŸ‹</button>
        </div>
    </div>

    <!-- Admin Panel Modal -->
    <div id="admin-panel-modal" class="fixed inset-0 bg-slate-950/95 backdrop-blur-xl z-[110] hidden items-center justify-center p-4">
        <div class="bg-slate-900 w-full max-w-4xl max-h-[90vh] flex flex-col p-6 lg:p-8 rounded-[2.5rem] border border-white/10 text-white overflow-hidden shadow-2xl">
            
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
                <div class="flex items-center gap-4">
                    <div class="bg-amber-500 w-12 h-12 rounded-2xl flex items-center justify-center text-2xl">ğŸ“‹</div>
                    <div>
                        <h3 class="text-xl font-black">ášá”á¶á™á€á¶ášááŸ</h3>
                        <p class="text-[9px] text-slate-500 font-bold uppercase tracking-widest">á‘á·á“áŸ’á“á“áŸá™á¢áŸ’á“á€á”áŸ’ášá¾á”áŸ’ášá¶áŸáŸ‹</p>
                    </div>
                </div>
                
                <div class="flex gap-3 items-center">
                    <div class="stat-card px-4 py-2 rounded-xl text-center">
                        <div class="text-[8px] font-black text-amber-500 uppercase">áŸášá»á”</div>
                        <div class="text-lg font-black"><span id="user-total-count">0</span> <span class="text-[10px] text-slate-500">á“á¶á€áŸ‹</span></div>
                    </div>
                    <div class="stat-card px-4 py-2 rounded-xl text-center">
                        <div class="text-[8px] font-black text-blue-400 uppercase">Login</div>
                        <div class="text-lg font-black"><span id="total-logins">0</span> <span class="text-[10px] text-slate-500">áŠá„</span></div>
                    </div>
                    <button onclick="toggleModal('admin-panel-modal')" class="w-10 h-10 flex items-center justify-center bg-white/5 hover:bg-red-600 rounded-full transition-all text-xl">âœ•</button>
                </div>
            </div>

            <!-- Admin Settings Section -->
            <div class="bg-amber-500/10 p-5 rounded-3xl border border-amber-500/20 mb-6 flex flex-col sm:flex-row justify-between items-center gap-4">
                <div class="text-center sm:text-left">
                    <span class="text-[10px] font-black text-amber-500 uppercase tracking-widest block mb-1">áŸá»áœááŸ’áá·á—á¶á–á‚áá“á¸</span>
                    <span class="text-sm font-bold text-white italic">á›áŸááŸá˜áŸ’á„á¶ááŸ‹ Admin ááŸ’ášá¼áœá”á¶á“á€á¶ášá–á¶ášá™áŸ‰á¶á„áá¹á„ášáŸ‰á¹á„</span>
                </div>
                <button onclick="changeAdminPasswordPrompt()" class="btn-admin px-6 py-2 rounded-xl text-[10px] font-black shadow-lg">á”áŸ’áá¼ášá›áŸááŸá˜áŸ’á„á¶ááŸ‹ Admin</button>
            </div>

            <!-- Add User Section -->
            <div class="bg-white/5 p-5 rounded-3xl border border-white/5 mb-6">
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-3 items-end">
                    <div class="space-y-1">
                        <label class="text-[9px] uppercase font-black text-slate-500 ml-2 tracking-widest">Username</label>
                        <input type="text" id="new-username" class="w-full bg-slate-950 border border-slate-800 rounded-xl p-2 text-sm text-white outline-none focus:border-amber-500">
                    </div>
                    <div class="space-y-1">
                        <label class="text-[9px] uppercase font-black text-slate-500 ml-2 tracking-widest">Password</label>
                        <input type="text" id="new-password" class="w-full bg-slate-950 border border-slate-800 rounded-xl p-2 text-sm text-white outline-none focus:border-amber-500">
                    </div>
                    <button onclick="addUser()" class="btn-primary h-10 rounded-xl font-black text-xs text-white shadow-lg w-full">á”á“áŸ’ááŸ‚á˜á¢áŸ’á“á€á”áŸ’ášá¾ááŸ’á˜á¸</button>
                </div>
            </div>

            <div class="flex-1 overflow-y-auto pr-1 custom-scrollbar">
                <div id="user-list-container" class="space-y-2 pb-4 mt-2"></div>
            </div>
        </div>
    </div>

    <script>
        const playlist = [
            { title: "Rampage (2018) Full Movie", url: "https://geo.dailymotion.com/player/xifi9.html?video=x9a08k8", desc: "áŸá€á˜áŸ’á˜á—á¶á–á”áŸ’ášá™á»á‘áŸ’á’áŠáŸá‡á€áŸ‹á…á·ááŸ’áášáœá¶á„áŸááŸ’áœá™á€áŸ’áŸ á“á·á„áá½á¢á„áŸ’á‚á¯á€áŸ”" },
            { title: "Big Buck Bunny HD", url: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", desc: "áœá¸áŠáŸá¢á¼áŸá˜áŸ’ášá¶á”áŸ‹ááŸáŸáŸ’ááŸá¶á€á›áŸ’á”á„á€á˜áŸ’ášá·áá…áŸ’á”á¶áŸáŸ‹áŸ”" }
        ];

        const DEFAULT_ADMIN_PASS = "123";

        function getLatestAdminPass() {
            return localStorage.getItem('vod_admin_pass') || DEFAULT_ADMIN_PASS;
        }

        let authorizedUsers = JSON.parse(localStorage.getItem('vod_users')) || [];
        let currentUser = null;
        let isAdmin = false;
        let activeVideoIdx = -1;
        
        // á€áŸ‚á›á˜áŸ’á¢á€á¶ášá‚áŸ’ášá”áŸ‹á‚áŸ’ášá„ Session á±áŸ’á™á˜á¶á“á—á¶á–á”ááŸ‹á”áŸ‚á“
        const sessionID = sessionStorage.getItem('session_id') || Math.random().toString(36).substr(2, 9);
        sessionStorage.setItem('session_id', sessionID);

        function initApp() {
            const loggedUser = localStorage.getItem('logged_in_user');
            
            // á”áŸ’ášáŸá·á“á”á¾á˜á¶á“ User á’áŸ’á›á¶á”áŸ‹ Login á‘á»á€á€áŸ’á“á»á„ LocalStorage
            if (loggedUser) {
                // á–á·á“á·ááŸ’á™á˜á¾á›áá¶áá¾ User á“áŸ„áŸ‡á“áŸ…á˜á¶á“á€áŸ’á“á»á„á”á‰áŸ’á‡á¸ášáºá¢ááŸ‹ (á€áŸ’ášáŸ‚á„á›áŸ„ Admin á›á»á”á…áŸ„á›)
                const userExists = authorizedUsers.some(u => u.user.toLowerCase() === loggedUser.toLowerCase());
                if (userExists) {
                    currentUser = loggedUser;
                    updateAuthUI();
                    renderPlaylist();
                    selectVideo(0);
                } else {
                    localStorage.removeItem('logged_in_user');
                    renderPlaylist();
                }
            } else {
                renderPlaylist();
            }
        }

        function renderPlaylist() {
            const listEl = document.getElementById('playlist');
            const lockEl = document.getElementById('playlist-lock');
            document.getElementById('video-count-badge').innerText = `${playlist.length} á—á¶á‚`;
            
            if (currentUser || isAdmin) {
                lockEl.style.display = 'none';
                listEl.innerHTML = playlist.map((v, i) => `
                    <div onclick="selectVideo(${i})" class="p-3 rounded-2xl cursor-pointer transition-all border ${activeVideoIdx === i ? 'bg-blue-600/20 border-blue-500/50' : 'bg-white/5 border-transparent hover:bg-white/10'}">
                        <div class="flex items-center gap-3 text-white">
                            <div class="w-8 h-8 rounded-lg flex items-center justify-center bg-black/40 text-[10px] font-black ${activeVideoIdx === i ? 'text-blue-400' : 'text-slate-500'}">${i+1}</div>
                            <span class="text-xs font-bold truncate">${v.title}</span>
                        </div>
                    </div>
                `).join('');
            } else {
                lockEl.style.display = 'flex';
                listEl.innerHTML = '';
            }
        }

        function renderUserTable() {
            const container = document.getElementById('user-list-container');
            document.getElementById('user-total-count').innerText = authorizedUsers.length;
            document.getElementById('total-logins').innerText = authorizedUsers.reduce((sum, u) => sum + (u.login_count || 0), 0);
            
            if (authorizedUsers.length === 0) {
                container.innerHTML = `<div class="py-10 text-center text-slate-600 text-sm font-bold uppercase tracking-widest">á‚áŸ’á˜á¶á“á‚áá“á¸á€áŸ’á“á»á„á”áŸ’ášá–áŸá“áŸ’á’</div>`;
                return;
            }

            container.innerHTML = authorizedUsers.map((u, idx) => `
                <div class="user-card grid grid-cols-12 gap-2 px-6 py-4 items-center mb-2">
                    <div class="col-span-5 flex items-center gap-3">
                        <div class="w-8 h-8 rounded-lg bg-slate-800 flex items-center justify-center text-xs font-black text-white">${u.user.charAt(0).toUpperCase()}</div>
                        <span class="text-sm font-bold text-white truncate">${u.user}</span>
                    </div>
                    <div class="col-span-3 text-center flex items-center justify-center gap-2">
                        <span class="bg-black/40 px-3 py-1 rounded-lg text-amber-500 font-mono text-xs border border-white/5 tracking-wider">${u.pass}</span>
                        <button onclick="copyPass('${u.pass}')" class="text-[10px] text-slate-500 hover:text-white">ğŸ“‹</button>
                    </div>
                    <div class="col-span-2 text-center text-blue-400 font-black text-sm">${u.login_count || 0}</div>
                    <div class="col-span-2 text-right"><button onclick="deleteUser(${idx})" class="text-red-500 hover:text-red-400 p-2 text-xs transition-colors">á›á»á”</button></div>
                </div>
            `).join('');
        }

        function copyPass(text) {
            const el = document.createElement('textarea');
            el.value = text;
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
            showToast("á”á¶á“á…á˜áŸ’á›á„á›áŸááŸá˜áŸ’á„á¶ááŸ‹!", "success");
        }

        function handleUserLogin() {
            const uInput = document.getElementById('login-user').value.trim();
            const pInput = document.getElementById('login-pass').value.trim();
            
            if (!uInput || !pInput) {
                showToast("áŸá¼á˜á”áŸ†á–áŸá‰áˆáŸ’á˜áŸ„áŸ‡ á“á·á„á›áŸááŸá˜áŸ’á„á¶ááŸ‹!", "error");
                return;
            }

            const userIdx = authorizedUsers.findIndex(u => u.user.toLowerCase() === uInput.toLowerCase() && u.pass === pInput);
            
            if (userIdx !== -1) {
                // á”á…áŸ’á…á»á”áŸ’á”á“áŸ’á“á—á¶á–á‘á·á“áŸ’á“á“áŸá™ Login
                authorizedUsers[userIdx].login_count = (authorizedUsers[userIdx].login_count || 0) + 1;
                localStorage.setItem('vod_users', JSON.stringify(authorizedUsers));
                
                // ášá€áŸ’áŸá¶á‘á»á€áŸáŸ’áá¶á“á—á¶á– Login
                localStorage.setItem('logged_in_user', authorizedUsers[userIdx].user);
                currentUser = authorizedUsers[userIdx].user;
                
                updateAuthUI();
                renderPlaylist();
                toggleModal('user-login-modal');
                showToast("á…á¼á›á”áŸ’ášá¾á”áŸ’ášá¶áŸáŸ‹á‡áŸ„á‚á‡áŸá™!", "success");
                
                // áŸá˜áŸ’á¢á¶á Input
                document.getElementById('login-user').value = '';
                document.getElementById('login-pass').value = '';
                
                selectVideo(0);
            } else {
                showToast("áˆáŸ’á˜áŸ„áŸ‡á¢áŸ’á“á€á”áŸ’ášá¾ á¬á›áŸááŸá˜áŸ’á„á¶ááŸ‹á˜á·á“ááŸ’ášá¹á˜ááŸ’ášá¼áœ!", "error");
            }
        }

        function handleAdminLogin() {
            const currentPass = getLatestAdminPass();
            const inputPass = document.getElementById('admin-pass-input').value.trim();
            
            if (inputPass === currentPass) {
                isAdmin = true;
                toggleModal('admin-login-modal');
                renderUserTable();
                renderPlaylist();
                toggleModal('admin-panel-modal');
                showToast("Welcome Admin!", "success");
                document.getElementById('admin-pass-input').value = "";
            } else {
                showToast("á›áŸááŸá˜áŸ’á„á¶ááŸ‹ Admin á˜á·á“ááŸ’ášá¹á˜ááŸ’ášá¼áœ!", "error");
            }
        }

        function changeAdminPasswordPrompt() {
            const currentPass = getLatestAdminPass();
            const oldP = prompt("á”á‰áŸ’á…á¼á›á›áŸááŸá˜áŸ’á„á¶ááŸ‹ Admin á”á…áŸ’á…á»á”áŸ’á”á“áŸ’á“ áŠá¾á˜áŸ’á”á¸á”á‰áŸ’á‡á¶á€áŸ‹:");
            
            if (oldP === null) return;

            if (oldP.trim() === currentPass) {
                const newP = prompt("á”á‰áŸ’á…á¼á›á›áŸááŸá˜áŸ’á„á¶ááŸ‹ Admin ááŸ’á˜á¸ (á™áŸ‰á¶á„áá·á… áŸ£ ááŸ’á‘á„áŸ‹):");
                if (newP && newP.trim().length >= 3) {
                    localStorage.setItem('vod_admin_pass', newP.trim());
                    showToast("á”á¶á“á”áŸ’áá¼ášá›áŸááŸá˜áŸ’á„á¶ááŸ‹ Admin ášá½á…ášá¶á›áŸ‹!", "success");
                } else if (newP !== null) {
                    showToast("á›áŸááŸá˜áŸ’á„á¶ááŸ‹ááŸ’á˜á¸ááŸ’á›á¸á–áŸá€!", "error");
                }
            } else {
                showToast("á›áŸááŸá˜áŸ’á„á¶ááŸ‹á”á…áŸ’á…á»á”áŸ’á”á“áŸ’á“á˜á·á“ááŸ’ášá¹á˜ááŸ’ášá¼áœ!", "error");
            }
        }

        function addUser() {
            const u = document.getElementById('new-username').value.trim();
            const p = document.getElementById('new-password').value.trim();
            
            if (!u || !p) return showToast("áŸá¼á˜á”áŸ†á–áŸá‰á‘á·á“áŸ’á“á“áŸá™á±áŸ’á™á‚áŸ’ášá”áŸ‹!", "error");
            if (authorizedUsers.some(user => user.user.toLowerCase() === u.toLowerCase())) return showToast("áˆáŸ’á˜áŸ„áŸ‡á“áŸáŸ‡á˜á¶á“ášá½á…á á¾á™!", "error");
            
            authorizedUsers.push({ user: u, pass: p, login_count: 0 });
            localStorage.setItem('vod_users', JSON.stringify(authorizedUsers));
            
            document.getElementById('new-username').value = '';
            document.getElementById('new-password').value = '';
            
            renderUserTable();
            showToast("á”á¶á“á”á“áŸ’ááŸ‚á˜á¢áŸ’á“á€á”áŸ’ášá¾ááŸ’á˜á¸", "success");
        }

        function deleteUser(idx) {
            if (confirm("áá¾á¢áŸ’á“á€á–á·áá‡á¶á…á„áŸ‹á›á»á”á¢áŸ’á“á€á”áŸ’ášá¾á“áŸáŸ‡á˜áŸ‚á“á‘áŸ?")) {
                authorizedUsers.splice(idx, 1);
                localStorage.setItem('vod_users', JSON.stringify(authorizedUsers));
                renderUserTable();
            }
        }

        function selectVideo(i) {
            if (!currentUser && !isAdmin) {
                toggleModal('user-login-modal');
                return;
            }
            activeVideoIdx = i;
            renderPlaylist();
            loadPlayer(playlist[i]);
        }

        function loadPlayer(video) {
            const wrapper = document.getElementById('player-wrapper');
            document.getElementById('current-title').innerText = video.title;
            document.getElementById('current-desc').innerText = video.desc;
            wrapper.innerHTML = `<iframe src="${video.url}&autoplay=1" allowfullscreen allow="autoplay"></iframe>`;
        }

        function updateAuthUI() {
            document.getElementById('user-status-display').innerText = `áŸáŸ’áá¶á“á—á¶á–: ${currentUser}`;
            document.getElementById('auth-btn').innerText = "Logout";
            document.getElementById('auth-btn').onclick = () => { 
                localStorage.removeItem('logged_in_user');
                location.reload(); 
            };
        }

        function toggleModal(id) {
            const m = document.getElementById(id);
            if (!m) return;
            if (m.classList.contains('hidden')) {
                m.classList.remove('hidden');
                m.classList.add('flex');
            } else {
                m.classList.add('hidden');
                m.classList.remove('flex');
            }
        }

        function handleAdminIconClick() {
            if (isAdmin) {
                renderUserTable();
                toggleModal('admin-panel-modal');
            } else {
                toggleModal('admin-login-modal');
            }
        }

        function showToast(msg, type) {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `notification ${type === 'success' ? 'bg-blue-600' : 'bg-red-600'} text-xs font-black shadow-2xl`;
            toast.innerText = msg;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 2500);
        }

        window.onload = initApp;
    </script>
</body>
</html>
